language: java

install:
  - "./gradlew clean"
  - "./gradlew assemble"
  - "./gradlew flashlibAll"

jdk:
  - oraclejdk9
  - oraclejdk11
  - openjdk8
  - openjdk9
  - openjdk10
  - openjdk11

env:
  global:
    - secure: o1czWNFUdXqcxOQprwEp1fbop6QGmG9NN0rZtDBAwnQrVKXlrIbTXEj30cQX++2yvJJLVxu2qI0wQzZaivNE3G0kAgPieo9AEtNNToE936hefsKUk9PgAKnfMfEksmFrUqoCJcFPUAOfe9DcIWv0h1DWbsoaXHAxwG8FG/BjGrpGMeIiz2WmL2efVrapC0TcrTdzhjdQBp4ZE8lV4LeLORcdhl1WEyxPthp23GZdYzqat+pZwcPzLOQ3Fg5SZa2AbMLwhfEC8QnuCZo3o3TtuTyzbPDLjb22Wv6OVOfItBaYdAKozmv8zKS9ZU1EuLsijmegBTYDgXPmVZVloUFG55DeoYYVYqlzeugY1V89xtZvhvnY1LfXPVm35+nBjMyInYig8pqvy7MmeMEvzpzVw8UAotGnx++5HrUGt62UD2Ek/7klHdpdH6cZXEIu9GOiXq0THxdUpCFvqr6BZzZz8SluEZ5FYcPPT9NBpPWj+0cYe5LdFMB+OgXShKYxE0vmVNv4K/jRDPWyJ4jH/XFTDHBkbxcmOZQO2rDtsUrXyvEvOVEswtoszop4h0ufWgeISYERxLxHxydwQ6RRShZkYwww8Z2rvhCTc5QC44pDs01HiWEbI2/pik0gFQqx34vGn1Ow3qIpF2lhdMhfU6WL/4YIY5SHbAZSzINY11WAzk0=
    - secure: hBkX0FwnpXAWe4xpV5gpdTqK1F0/VtPG0QrxQ3w83oqe5+OcQ/3oWTJPNVuHwDzECB36BEVdVP5DqSqyHHv8Nt2uxQZVL68vHei84mH4Ir32fnsmKTGIH86gFW0tTOBkaSE5ePgnCKKXx+0+GBIP1sUzHAQ8SU+2FQ2o4cDVOgSohgxmR69c4IFvmmeUee6xcsxrmi6ii0OarBi/KzucomWUQV/SpvuggPyY0XNrAoyNHDHjQver1JGlVYjydHSkQMDlDcuYGa+eafIjsLzY0nSB7Fx0cvcdMKSGyh1/mYIRUdAS+iyrO9fIPN7JKrLROe/xFjQZlQ2NM0we5dxK+9XEHrnsfm0GfwvJAUvYFhexyEbF3Kwggi+Tw8QHGkW/aNHazGxjtRIAomZQOPUq2wJyVkV0lf8qnMcpK0G2F8izkGAt8LXfiR8xRrVTRY7bXCHDN6xIZ+/FQhJYRXenDUq4mWiP3/8XpGIg4zV5rxH1dsHqLfWLv4sgdg6ExCqFAXM7IBbMLsftLFYHFcm/NmnHr/avBjgzOyBlBhPu01YTZYDBxl+CjVIHGJFiQNqI19prr7bmqJnS6vXeKz4DI+V+Bot161lUaXXtMrIloJ2cTIpgt1/QrhEyRnWCYzvx86d9KOV91evbjdbGs0moy/XqGPpbGvvE8rU/dgY5C1s=
    - secure: I7r4XZ85d9OtXdi96Ajyq5gLmY27CrQ7sJboZivpc9DcEVs9AqXHskxdqCkgpvkmDQDJr9xsDY3SZzbl1ASulgn3CSsinhuY1SML5q31p22att+SKD2AfrnOu1ru0a1W141UMwaNrpR7sfJprfkiwK+pyZ9mhjJA2ke4t7LvkzysetAAWo7+uLCw5CVzKHsykrvBczZ7ooBDuDx7zzxKkLe6yDc5+aVpybOtqwGLMQj5kKBjiYHm7gaSAX0Bx1Ng4XVEH5S6tt6M/dqVEpsmJlgDGC5M+yN+jJiftggQEoIDcpJQ42zFjeNtuNqkKmvXDBWxtnynN0j9URXhb97gHn8lg4Aoa9sin0OEAieQED7Ekf36DazzGEVPNyLt8wmOwcrZBIWoE+/Rsm3JqYrv+lgxfwVWTRQUsTi4Pnn8LTdZCIN2o56nOjmJDna4p5E7XXrhKU8MFFkTYfp1x8OBYmxbvEghjxRmCxCQbLdGLp0kFxTC2MdJd3HZIV4ML0NxKV4iuIMZG1DiJKiqQhXv5obNGQydir3YVcOayNlTU56182ygghFWh3ucSN2Mg4qvlH+Rz405nRlFFKl7kwDcn5g099tHDhl0z2UUYA3gczQObzVkVL+ih/CbEbENjGkd6ovg12yA2ZLEv0kV+DxDLkry+90Qp11tOI2virWFxH0=
    - secure: YM9wRujqdRqUZcMZeuONl+tgow1yDBjPwKyYc5xUIF9/sLCfcggTq+frnv9jGCiopuKn0Fm7SLhl4fVHBXzNX6niIUXPCsh3C257MWhCqEKO2TRXiXtPEdN+/1KZb6b2gOs+XzWT6n1ZLa5R89WS9iYa+J8inOLJLa7TeTRu95m2CNYuel34cWWeDl27rsBKWTGLWwjFhMOwklTqXgWPjB6egfYrX7q7Bk+bWHwFJAJ/A1jJO9+fRaUkehOe9Wa42cOZq9F20ZNcTnaGJR6Ak3AZQ8+1cFPYMxALYubFcH73FRJ6r9I2F8T4/7WqP4Y00sknkGg8mV1BtltABl1blemXyDR6i+GAGl10Kb1Dbz3SyxOfiftxZp8cmsjfsVNlQr6QLDQ3etKReHTThV1QmOiwUJIIFJlnuM9TykKvHas1VQfHuOFOVWYMeVXUyB6En+6ABq662Ub7KkQqJi1J6BL/XuzeE1ugk3p1ZdU89RsV7m3U0esyQWIOp1+ZG7EstR0CxpqmZq5hvtB7JfRs4cFFx33FuwqQFtejOoGHZlXaX3nRuueXAbgpoVHT/BAMnIShQMIN4Q+onrDijV3ayXvwUhCa+da8dSfwXfSbyI6SEL3BgHpvrncDi3f96dA5+yxzyvs1YuNDTU4B9LldLzFfU64rHpxA4ujEghV7lD0=

before_install:
  - openssl aes-256-cbc -K $encrypted_fbb72a476077_key -iv $encrypted_fbb72a476077_iv -in secring.gpg.enc -out secring.gpg -d
  - gpg --import secring.gpg  

script:
  - "./gradlew check"

before_deploy:
  - git config --local user.name "Travis CI"
  - git config --local user.name "build@travis-ci.com"

deploy:
  - provider: script
    script: ./gradlew publish -Psigning.keyId=${GPG_KEY_ID} -Psigning.password=${GPG_KEY_PASSPHRASE} -Psigning.secretKeyRingFile=secring.gpg
    skip_cleanup: true
    on:
      condition: "$TRAVIS_TAG =~ ^v[0-9]+\\.[0-9]+\\.[0-9]+(-.*)?"
      branch: master
      tags: true
  - provider: releases
    api_key:
      secure: YYgG8TieQ9qBjLyHX1p+MxJBP2YoCUoJvrVi0VpikZyvODb6LF+S9WF5Yiy1swFPvfQOzcoU1Goij7NSJQbzQ+a0a4DKMOGGfz+M6cwNSrRmvGJC58XMIQP6c9rk5Q+hQIEU7FTfxbKQruy4h8tr5dohts0c5/N1s8kOxiQzDRhiuo2r083xdvV340UUjw3wum3hwogP2GurB9PeHCdd9CRJ9XIWpqXT4MIbySFapZr1CkpE/5nTsmGuKKwAX6l5J58TOKed+EDaOdmBBnBBl1tetvt08XSlHn8NiGAQjXGCPYrZl7t/BvExbmARytd72aw7HWNHuSlPiJP5XZHK4kx8zp5Na07P2pkFfHDV8gySPQmOp+DK78hBVPG67dO8zKVdZVtwGWskZuLApBbSPjsAUvtJH86uFqN76+p7Y3FNmZg6amOcWZVoaCNHuxuNZqgCylxAEu8AeQbuUHQUdAyO8CJVlKMG2CJfJOVWaRDcESQwWhkoBjb4ilEfdD6Y6N+psZUl+9P3gwr5HASbcGxLa1vjWJh1e7QBUNBNNZbOREXWy5ViUqy03hdaEslOA/mKDK9ImxUs/erVJunAZHU/gCrmxkQkGx18uTMHZkJOh8yg7PI65EZad5EViwBAVeH6om42OOxptw/cOigFsMKi7P2KgJ6Qv7oeoGYykN0=
    file:
      - build/flashlib-all.jar
      - README.md
    skip_cleanup: true
    draft: true
    on:
      condition: "$TRAVIS_TAG =~ ^v[0-9]+\\.[0-9]+\\.[0-9]+(-.*)?"
      repo: Flash3388/FlashLib
      branch: master
      tags: true
